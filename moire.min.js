// +----------------------------------------------------------------------
// | Name 云纹框架
// +----------------------------------------------------------------------
// | Author 唐启云 <tqy@fxri.net>
// +----------------------------------------------------------------------
// | Copyright Copyright © 2017-2099 方弦研究所. All rights reserved.
// +----------------------------------------------------------------------
// | Link https://www.fxri.net
// +----------------------------------------------------------------------
// | Version v0.4
// +----------------------------------------------------------------------
var fxApp={env:{version:"v0.4"}};fxApp["env"]["script"]=document.getElementsByTagName("script");fxApp["env"]["script"]=fxApp["env"]["script"][fxApp["env"]["script"].length-1].src;fxApp["env"]["script"]=fxApp["env"]["script"].replace(/\/[^\/]*$/,"");var fxLocal=new function(){return isObject(fxLocal)?fxLocal:{}};fxLocal["set"]=function(){var e=isSet(arguments[0])?arguments[0]:null,t=isSet(arguments[1])?arguments[1]:null;return localStorage.setItem(e,JSON.stringify(t))};fxLocal["get"]=function(){var e=isSet(arguments[0])?arguments[0]:null;return JSON.parse(localStorage.getItem(e))};fxLocal["remove"]=function(){var e=isSet(arguments[0])?arguments[0]:null;return localStorage.removeItem(e)};fxLocal["clear"]=function(){return localStorage.clear()};var fxSession=new function(){return isObject(fxSession)?fxSession:{}};fxSession["set"]=function(){var e=isSet(arguments[0])?arguments[0]:null,t=isSet(arguments[1])?arguments[1]:null;return sessionStorage.setItem(e,JSON.stringify(t))};fxSession["get"]=function(){var e=isSet(arguments[0])?arguments[0]:null;return JSON.parse(sessionStorage.getItem(e))};fxSession["remove"]=function(){var e=isSet(arguments[0])?arguments[0]:null;return sessionStorage.removeItem(e)};fxSession["clear"]=function(){return sessionStorage.clear()};function isJson(e){try{var t=JSON.parse(e);return typeof t=="object"&&t}catch(e){}return false}function isEmpty(e){switch(Object.prototype.toString.call(e)){case"[object Null]":case"[object Undefined]":return true;case"[object Boolean]":case"[object Number]":return!e;case"[object String]":e=parseInt(e)+""==e?parseInt(e):e;if(typeof e==="number"){e=!e}else{e=!e.length}return e;case"[object Array]":return!e.length;case"[object Object]":return!Object.keys(e).length}return false}function isUndefined(e){return e===undefined}function isNull(e){return e===null}function isSet(e){return e!==null&&e!==undefined}function isBlank(e){return!isSet(e)||e===""}function isArray(e){return Array.isArray(e)}function isObject(e){return $.isPlainObject(e)||Object.prototype.toString.call(e)=="[object Arguments]"}function isAorO(e){return isArray(e)||isObject(e)}function isHtml(e){var t=document.createElement("div");try{if(e instanceof $)return true;t.appendChild(e.cloneNode(true));return e.nodeType==1}catch(e){}return e==window||e==document}function isFunction(e){return typeof e==="function"}function isString(e){return typeof e=="string"}function isNumeric(e){switch(typeof e){case"string":case"number":return parseFloat(e)==e&&!isNaN(e)}return false}function isMobile(e){var t=/^1\d{10}$/;return t.test(e)}function isEmail(e){var t=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;return t.test(e)}function isMoney(e){var t=/^(([1-9]\d*)|\d)(\.\d{1,2})?$/;return t.test(e)}if(!isFunction(history.replaceState)){history.replaceState=function(){}}if(!isFunction(Object.assign)){Object.assign=function(e){"use strict";if(e==null){throw new TypeError("Cannot convert undefined or null to object")}e=Object(e);for(var t=1;t<arguments.length;t++){var a=arguments[t];if(a!=null){for(var i in a){if(Object.prototype.hasOwnProperty.call(a,i)){e[i]=a[i]}}}}return e}}if(!isFunction(Object.keys)){Object.keys=function(){var n=Object.prototype.hasOwnProperty,s=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=r.length;return function(e){if(typeof e!=="object"&&typeof e!=="function"||e===null)throw new TypeError("Object.keys called on non-object");var t=[];for(var a in e){if(n.call(e,a))t.push(a)}if(s){for(var i=0;i<l;i++){if(n.call(e,r[i]))t.push(r[i])}}return t}}()}if(!isFunction(Object.values)){Object.values=function(e){if(e!==Object(e))throw new TypeError("Object.values called on a non-object");var t=[],a;for(a in e){if(Object.prototype.hasOwnProperty.call(e,a)){t.push(e[a])}}return t}}var fxBase=new function(){return isObject(fxBase)?fxBase:{}};fxBase["base"]=Object.assign(isObject(fxBase["base"])?fxBase["base"]:{},{mould:function(){var e={};e={type:null,cell:null,param:[]};e=fxBase["param"]["merge"](e,arguments[0]);e["type"]=isSet(e["type"])?"moire-type,"+e["type"]:null;e["cell"]=isSet(e["cell"])?"moire-cell,"+e["cell"]:null;if(isArray(e["param"]))e["param"].unshift({});return fxBase["dom"]["mould"](e)},template:function(){var e={};e={cell:null,param:[]};e=fxBase["param"]["merge"](e,arguments[0]);e["cell"]=isSet(e["cell"])?"moire-cell,"+e["cell"]:null;if(isArray(e["param"]))e["param"].unshift({});return fxBase["dom"]["template"](e)},lang:function(e){if(!isSet(fxApp["view"]["lang"])||!isSet(fxApp["view"]["langs"]))return e;var t=fxBase["base"]["langList"](e),a=fxBase["base"]["langParse"](t);return a.charAt(0).toUpperCase()+a.slice(1)},langList:function(e){var a=[];if(isAorO(e)){$.each(e,function(e,t){a.push(fxBase["base"]["langList"](t))})}else{e+="";if(!isSet(e)){a="null"}else if(e.indexOf(fxApp["view"]["langc"]["prefix"])===0){a=e.substr(fxApp["view"]["langc"]["prefix"].length)}else if(e.indexOf(fxApp["view"]["langc"]["ignore"])===0){a=""}else{if(isNumeric(e)){e=String(e)}a=fxApp["view"]["langs"][e];if(undefined==a)a=e}}return a},langParse:function(a){var e=fxApp["view"]["lang"],t;if(isAorO(a)){$.each(a,function(e,t){if(isAorO(t)){a[e]=fxBase["base"]["langParse"](t)}});switch(e){default:case"en-us":t=a.join(" ");break;case"zh-cn":t=a.join("");break}}else{t=a}return t},maxZIndex:function(){var e=fxBase["dom"]["maxZIndex"]();return e>0?e:0},explode:function(){var e=fxBase["text"]["explode"].apply(null,arguments),a=[];if(!isSet(arguments[1])||""==arguments[1])return a;$.each(e,function(e,t){if(!fxBase["param"]["inArray"](t,a)){a.push(t)}});return a},json:function(){var e=isSet(arguments[0])?arguments[0]:null,t=isSet(arguments[1])?arguments[1]:"";t=t.toLowerCase();switch(t){case"encode":if(!isJson(e)){e=JSON.stringify(e)}break;case"decode":if(isJson(e)){e=JSON.parse(e)}else if(isObject(e)){e=Object.values(e)}else if(isString(e)){e=fxBase["text"]["strDecode"](e)}else if(!isArray(e)){e=isSet(e)?[e]:[]}break}return e}});fxBase["client"]=Object.assign(isObject(fxBase["client"])?fxBase["client"]:{},{ieVersion:function(){var e=navigator.userAgent;var t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1;var a=e.indexOf("Edge")>-1&&!t;var i=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1;if(t){var n=new RegExp("MSIE (\\d+\\.\\d+);");n.test(e);var s=parseFloat(RegExp["$1"]);if(s==7){return 7}else if(s==8){return 8}else if(s==9){return 9}else if(s==10){return 10}else{return 6}}else if(a){return"edge"}else if(i){return 11}else{return-1}}});fxBase["data"]=Object.assign(isObject(fxBase["data"])?fxBase["data"]:{},{fieldParse:function(){var a={};a["data"]=arguments[0];a["field"]=arguments[1];a["joint"]=!isBlank(arguments[2])?arguments[2]:"-_";if(!isAorO(a["data"])&&!isString(a["field"])&&!isString(a["joint"])){return false}a["field"]=fxBase["text"]["explode"](a["joint"],a["field"]);$.each(a["field"],function(e,t){if(!isBlank(a["data"][t])){a["data"]=a["data"][t]}else{a["data"]="";return false}});return a["data"]},fieldValue:function(){var i={};i["field"]=arguments[0];i["value"]=arguments[1];i["joint"]=!isBlank(arguments[2])?arguments[2]:"-_";if(!isString(i["field"])&&!isString(i["joint"])){return false}$.each(fxBase["text"]["explode"](i["joint"],i["field"]).reverse(),function(e,t){var a={};a[t]=i["value"];i["value"]=a});return i["value"]}});fxBase["dom"]=Object.assign(isObject(fxBase["dom"])?fxBase["dom"]:{},{css:function(){var a={};a["elem"]=isSet(arguments[0])?arguments[0]:null;a["name"]=isSet(arguments[1])?arguments[1]:null;a["value"]=isSet(arguments[2])?arguments[2]:null;if(!isSet(a["elem"]))return;if(undefined==a["elem"].length){a["elem"]=[a["elem"]]}a["elem"]=a["elem"][0];if(isObject(a["name"])){$.each(a["name"],function(e,t){a["elem"].style[e]=t})}else if(!isSet(a["value"])){a["style"]=window.getComputedStyle(a["elem"],null)||a["elem"].currentStyle;return a["style"][a["name"]]}else if(isSet(a["name"])){a["elem"].style[a["name"]]=a["value"]}},style:function(){var a={};a["elem"]=isSet(arguments[0])?arguments[0]:null;a["name"]=isSet(arguments[1])?arguments[1]:null;a["value"]=isSet(arguments[2])?arguments[2]:null;if(!isSet(a["elem"]))return;a["elem"]=$(a["elem"]);if(isObject(a["name"])){$.each(a["name"],function(e,t){a["elem"].css(e,t)})}else if(!isSet(a["value"])){a["list"]=a["elem"].attr("style");if(!isSet(a["list"])){a["list"]=""}else if(!isString(a["list"])){a["list"]=Stzring(a["list"])}a["list"]=fxBase["text"]["explode"](";",a["list"]);a["style"]={};$.each(a["list"],function(e,t){a["split"]=fxBase["text"]["explode"](":",t);if(a["split"].length!=2)return true;a["style"][$.trim(a["split"][0])]=$.trim(a["split"][1])});return a["style"][a["name"]]}else if(isSet(a["name"])){a["elem"].css(a["name"],a["value"])}},mould:function(){var i={elem:null,type:null,cell:null,title:null,data:{},param:[]};i=fxBase["param"]["merge"](i,arguments[0]);if(!isSet(i["elem"])){console.log(fxBase["base"]["lang"](["lack","element"]));return}if(!isEmpty(i["data"])){fxView["shelf"]["view"]["data"]=fxBase["param"]["merge"](fxView["shelf"]["view"]["data"],i["data"])}if(isBlank(i["type"])){i["type"]=[]}else if(!isAorO(i["type"])){i["type"]=fxBase["text"]["explode"](",",i["type"])}if(isBlank(i["title"])){i["title"]=[]}else if(!isAorO(i["title"])){i["title"]=fxBase["text"]["explode"](",",i["title"])}i["pack"]=$("<div></div>");i["elem"]=$("<div></div>").append($(i["elem"]).html());$(i["type"]).each(function(e,t){if(e===0||t==="")return true;if(t!="*"){t="["+i["type"][0]+"="+t+"]"}else{t="["+i["type"][0]+"]"}i["pack"].append(i["elem"].children(t).html())});if(isSet(i["cell"])){i["elem"].html("");i["cell"]=fxBase["text"]["explode"](",",i["cell"]);$(i["cell"]).each(function(a,e){if(a===0||e==="")return true;if(e!="*"){e="["+i["cell"][0]+"="+e+"]"}else{e="["+i["cell"][0]+"]"}i["pack"].find(e).each(function(e,t){i["elem"].append($(t).attr(i["param"][a]).prop("outerHTML"))})});i["param"][key]=isObject(i["param"][key])?i["param"][key]:{};i["elem"].children().each(function(e,t){if(!isSet(i["title"][e])||i["title"][e]==""){i["title"][e]=$(t).html()}$(t).html(fxBase["base"]["lang"](fxBase["text"]["explode"](".",i["title"][e])))})}else{i["elem"].html(i["pack"].children())}return i["elem"]},template:function(){var i={stock:fxView["machine"]["caller"](["material","template"]),elem:null,type:null,cell:null,title:null,data:{},param:[]};i=fxBase["param"]["merge"](i,arguments[0]);if(!isSet(i["elem"])){console.log(fxBase["base"]["lang"](["lack","element"]));return}if(!isEmpty(i["data"])){fxView["shelf"]["view"]["data"]=fxBase["param"]["merge"](fxView["shelf"]["view"]["data"],i["data"])}if(isBlank(i["type"])){i["type"]=[]}else if(!isAorO(i["type"])){i["type"]=fxBase["text"]["explode"](",",i["type"])}if(isBlank(i["title"])){i["title"]=[]}else if(!isAorO(i["title"])){i["title"]=fxBase["text"]["explode"](",",i["title"])}i["pack"]=$("<div></div>");i["elem"]=i["stock"][i["elem"]];$(i["type"]).each(function(e,t){if(t!="*"){t=i["elem"][t]}else{t=fxBase["text"]["implode"]("",Object.values(i["elem"]))}i["pack"].append(t)});i["elem"]=$("<div></div>");if(isSet(i["cell"])){i["cell"]=fxBase["text"]["explode"](",",i["cell"]);$(i["cell"]).each(function(a,e){if(a===0||e==="")return true;if(e!="*"){e="["+i["cell"][0]+"="+e+"]"}else{e="["+i["cell"][0]+"]"}i["param"][a]=isObject(i["param"][a])?i["param"][a]:{};i["pack"].find(e).each(function(e,t){i["elem"].append($(t).attr(i["param"][a]).prop("outerHTML"))})});i["elem"].children().each(function(e,t){if(!isSet(i["title"][e])||i["title"][e]==""){i["title"][e]=$(t).html()}$(t).html(fxBase["base"]["lang"](fxBase["text"]["explode"](".",i["title"][e])))})}else{i["elem"].html(i["pack"].children())}return i["elem"]},drag:function(){var f={elem:null,time:0,target:null,wall:false,z_index:fxBase["base"]["maxZIndex"]()+1,css:{},edge:$(document),edgeX:null,edgeY:null,switch:true};var c={};f=fxBase["param"]["merge"](f,arguments[0]);if(!isSet(f["elem"])){console.log(fxBase["base"]["lang"](["please","choice","valid","HTML","label"]));return}$(f["elem"]).off("mousedown",e);$(f["elem"]).off("touchstart",e);if(!f["switch"])return;$(f["elem"]).on("mousedown",e);$(f["elem"]).on("touchstart",e);function e(e){var n;if(e.originalEvent.targetTouches){n=e.originalEvent.targetTouches[0]}else{n=e;if(e.button!=0)return}f["is_move"]=false;c["elem"]=f["target"]?$(f["target"]):$(this);c["z_index"]=fxBase["dom"]["style"](c["elem"],"z-index");c["href"]=c["elem"].attr("href");c["elem"].css("z-index",f["z_index"]);c["elem"].attr("href","javascript:void(0);");f["css"]["select"]=$("body").css("user-select");fxApp["rank"]["timer.mouse.drag"]=setTimeout(function(){var e=c["elem"].offset().left,t=c["elem"].offset().top,a=parseFloat(c["elem"].css("left")),i=parseFloat(c["elem"].css("top"));f["getX"]=n.pageX-(e+(a-e));f["getY"]=n.pageY-(t+(i-t));$("body").css("user-select","none");$(document).on("mousemove",s);$(this).on("touchmove",s)},f["time"]);$(document).on("mouseup",t);$(this).on("touchend",t)}function s(e){var t;if(e.originalEvent.targetTouches){t=e.originalEvent.targetTouches[0]}else{t=e}var a=t.pageX-f["getX"],i=t.pageY-f["getY"],n,s,r,l;f["is_move"]=true;if(true===f["wall"]){n=c["elem"].outerWidth(true);s=c["elem"].outerHeight(true);r=isSet(f["edgeX"])?f["edgeX"]:f["edge"].scrollLeft();l=isSet(f["edgeY"])?f["edgeY"]:f["edge"].scrollTop();if(a<r){a=r}else if(a>$(document).outerWidth(true)-n+r){a=$(document).outerWidth(true)-n+r}if(i<l){i=l}else if(i>$(document).outerHeight(true)-s+l){i=$(document).outerHeight(true)-s+l}}c["elem"].css({left:a,top:i})}function t(e){clearTimeout(fxApp["rank"]["timer.mouse.drag"]);$("body").css("user-select",f["css"]["select"]);$(document).off("mousemove",s);$(document).off("mouseup",t);$(this).off("touchmove",s);$(this).off("touchend",t);c["elem"].css("z-index",c["z_index"]);if(!isSet(c["href"])){c["elem"].removeAttr("href")}else if(!f["is_move"]){c["elem"].attr("href",c["href"])}else{clearTimeout(fxApp["rank"]["timer.mouse.drag"]);fxApp["rank"]["timer.mouse.drag"]=setTimeout(function(){c["elem"].attr("href",c["href"])},10)}}},trigger:function(){function e(){window.location.replace($(this).attr("fxy-href"))}$(document).off("click",e);$(document).on("click","a[fxy-href]",e)},maxZIndex:function(){var e=Math.max.apply(null,$.map($("body *"),function(e,t){if($(e).css("position")!="static")return parseInt($(e).css("z-index"))||-1}));var t=Math.max.apply(null,$.map($(parent.document).find("body *"),function(e,t){if($(e).css("position")!="static")return parseInt($(e).css("z-index"))||-1}));return e>t?e:t}});fxBase["file"]=Object.assign(isObject(fxBase["file"])?fxBase["file"]:{},{classMethod:function(e){if(!isObject(e))return;var a={param:{},method:[]};$.each(e,function(e,t){if(t!=null){a["param"][e]=t}else{a["method"].push(e)}});return a},pathExt:function(e){last_len=e.lastIndexOf(".");len=e.length;ext=e.substring(last_len+1,len);return ext}});fxBase["math"]=Object.assign(isObject(fxBase["math"])?fxBase["math"]:{},{rand:function(e,t){if(arguments.length<2){t=e;e=0}if(e>t){var a=t;t=e;e=a}return Math.floor(Math.random()*(t-e+1))+e}});fxBase["param"]=Object.assign(isObject(fxBase["param"])?fxBase["param"]:{},{define:function(){var a=isSet(arguments[0])?arguments[0]:null,e=isSet(arguments[1])?arguments[1]:null,i={};if(!isArray(a)){return false}switch(e){default:i=a;break;case"1.1.1":i=a[0];$.each(a[1],function(e,t){if(!isSet(i[e])){i[e]=t}});break;case"1.1.2":i=a[0];$.each(a[1],function(e,t){if(!isSet(i[e])||""===i[e]){i[e]=t}});break;case"1.1.3":i=a[0];$.each(a[1],function(e,t){if(!isSet(i[e])){i[e]=t}});$.each(a[1],function(e,t){i[e]=fxBase["base"]["json"](i[e],"decode")});break;case"1.2.1":i=a[0];$.each(a[1],function(e,t){if(!isSet(i[t])){i[t]=null}});break;case"1.2.2":i=a[0];$.each(a[1],function(e,t){if(!isSet(i[t])||""===i[t]){i[t]=null}});break;case"1.2.3":i=a[0];$.each(a[1],function(e,t){i[t]=fxBase["base"]["json"](isSet(i[t])?i[t]:null,"decode")});break;case"1.2.4":i=a[0];$.each(a[1],function(e,t){if(!isSet(i[t])||""===i[t]){i[t]={}}else if(isString(i[t])||isNumeric(i[t])){i[t]=fxBase["text"]["explode"](",",i[t])}else if(!isArray(i[t])){i[t]={}}});break;case"1.3.1":i=a[0];$.each(a[1],function(e,t){if(isSet(t)){i[e]=t}});break;case"1.3.2":i=a[0];$.each(a[1],function(e,t){if(isSet(t)){i[e]=t}else if(!isSet(i[e])||""===i[e]){i[e]=null}});break;case"2.1.1":$.each(a[1],function(e,t){if(!isSet(a[0][e])){i[e]=t}else{i[e]=a[0][e]}});break;case"2.1.2":$.each(a[1],function(e,t){if(!isSet(a[0][e])||""===a[0][e]){i[e]=t}else{i[e]=a[0][e]}});break;case"2.2.1":$.each(a[1],function(e,t){if(!isSet(a[0][t])){i[t]=null}else{i[t]=a[0][t]}});break;case"2.2.2":$.each(a[1],function(e,t){if(!isSet(a[0][t])||""===a[0][t]){i[t]=null}else{i[t]=a[0][t]}});break}return i},merge:function(){var a=[],e=[],t;$.each(arguments,function(e,t){a.push(t)});t=a.shift();t=isSet(t)?t:-1;if(!isNumeric(t)){a.unshift(t);t=-1}if(a.length<2){return a.shift()}else if(a.length>2){e[0]=a.shift();a.unshift(t);e[1]=fxBase["param"]["merge"].apply(null,a)}else{e=a}return fxBase["param"]["cover"](e,t)},cover:function(){var a=isSet(arguments[0])?arguments[0]:null,i=isSet(arguments[1])?arguments[1]:-1;if(i>0){i--}if(!isAorO(a[0])){a[0]=a[1]}else if(isAorO(a[1])){$.each(a[1],function(e,t){if(!isSet(a[0][e])){a[0][e]=t}else if(isAorO(t)&&i!==0){a[0][e]=fxBase["param"]["cover"]([a[0][e],t],i)}else{a[0][e]=t}})}return a[0]},url:function(){var e={type:null,window:window,url:null,name:null,param:{}};e=fxBase["param"]["merge"](e,arguments[0]);switch(e["type"]){case"1.1":e["param"]=fxBase["param"]["merge"](fxBase["param"]["url"]({type:"2.1",window:e["window"]}),e["param"]);case"1.2":e["url"]=!isBlank(e["url"])?e["url"]:e["window"].location.pathname;e["url"]=fxBase["text"]["explode"]("?",e["url"],2);e["url"][1]=fxBase["param"]["merge"](fxBase["text"]["strDecode"](e["url"][1]),fxBase["text"]["strDecode"](e["param"]));if(!isEmpty(e["url"][1])){e["url"][1]=fxBase["text"]["strEncode"](e["url"][1])}else{e["url"].splice(1,1)}return fxBase["text"]["implode"]("?",e["url"]);case"2.1":e["url"]=!isBlank(e["url"])?e["url"]:e["window"].location.href;e["url"]=fxBase["text"]["explode"]("?",e["url"],2);e["url"][1]=fxBase["param"]["merge"](fxBase["text"]["strDecode"](e["url"][1]),fxBase["text"]["strDecode"](e["param"]));if(!isBlank(e["name"])){return e["url"][1][e["name"]]}return e["url"][1]}},inArray:function(){for(var e in arguments[1]){if(arguments[1][e]==arguments[0]){return true}}return false},arraySearch:function(){for(var e in arguments[1]){if(arguments[1][e]==arguments[0]){return e}}return false}});fxBase["proxy"]=Object.assign(isObject(fxBase["proxy"])?fxBase["proxy"]:{},{bind:function(){var i={};i["target"]=arguments[0];i["callback"]=arguments[1];if(!isAorO(i["target"])){return false}i["target"]=new Proxy(i["target"],{get:function(e,t){if(t.toString()=="__fx_pro_bin__")return true;return e[t]},set:function(e,t,a){if(isAorO(a)&&!a["__fx_pro_bin__"]){a=fxBase["proxy"]["bind"](a,i["callback"])}e[t]=a;if(isFunction(i["callback"])){clearTimeout(i["timer"]);i["timer"]=setTimeout(function(){i["callback"]()},30)}return true}});return i["target"]}});fxBase["text"]=Object.assign(isObject(fxBase["text"])?fxBase["text"]:{},{time:function(){var e=isSet(arguments[0])?arguments[0]:+new Date,t=isSet(arguments[1])?arguments[1]:false;e=parseInt(e);var a=new Date(e+8*3600*1e3);if(!isNumeric(a))return a;if(t){a=a.toJSON().replace("T"," ").replace("Z"," ")}else{a=a.toJSON().slice(0,-5).replace("T"," ")}return a},mtime:function(){var e=isSet(arguments[0])?arguments[0]:null,t=null;if(isNumeric(e)){e=String(e);if(e.length!=13){return false}t=fxBase["text"]["time"](e,true)}else if(isString(e)){e=e.replace(/-/g,"/");t=new Date(e).getTime()}else{t=(new Date).getTime()}return t},ftime:function(){var e=isSet(arguments[0])?arguments[0]:null,t=isSet(arguments[1])?arguments[1]:null,a=[];e=parseInt(e);var i={};var n={0:false,1:true,2:true,3:true,4:true,5:true,6:true};var s={0:"millisecond",1:"sec",2:"minute",3:"hour",4:"day",5:"month",6:"year"};var r=e;switch(t){default:case"1.1":break;case"1.2":n[0]=true;break}if(n[0]){i[0]=r%1e3;r=parseInt(r/1e3)}if(n[1]){i[1]=r%60;r=parseInt(r/60)}if(n[2]){i[2]=r%60;r=parseInt(r/60)}if(n[3]){i[3]=r%24;r=parseInt(r/24)}if(n[4]){i[4]=r%30;r=parseInt(r/30)}if(n[5]){i[5]=r%12;r=parseInt(r/12)}if(n[6]){i[6]=r}$.each(i,function(e,t){if(t==0){delete i[e]}});$.each(i,function(e,t){if(!isSet(t))return true;a.unshift(s[e]);a.unshift(String(t))});a=fxBase["base"]["lang"](a);return a},replace:function(e,t,a){var e=new RegExp(e,"g");a+="";return a.replace(e,t)},explode:function(){var e={0:null,1:null,2:null,3:null};e=fxBase["param"]["merge"](e,arguments);separator=e[0];data=e[1];howmany=isNumeric(e[2])?e[2]:null;type=isString(e[2])?e[2]:e[3];switch(type){case"regular":separator=new RegExp(separator,"g");break}if(isString(data)||isNumeric(data)){data+="";data=data.split(separator);if(isSet(howmany)&&howmany==0){data=[fxBase["text"]["implode"](separator,data)]}else if(isSet(howmany)&&howmany>=0&&data.length>howmany){data.unshift(fxBase["text"]["implode"](separator,data.slice(howmany-1)));data=data.slice(0,howmany);data.push(data.shift())}else if(isSet(howmany)&&howmany<0){data=data.slice(0,howmany)}}else if(!isSet(data)){data=[""]}else if(!isAorO(data)){data=[data]}return data},implode:function(){var e=isSet(arguments[0])?arguments[0]:null,t=isSet(arguments[1])?arguments[1]:null;if(isObject(t)){t=Object.values(t)}if(isArray(t)){t=t.join(e)}else if(!isSet(t)){t=[]}return t},strPad:function(){var e=isSet(arguments[0])?arguments[0]:null,t=isSet(arguments[1])?arguments[1]:null,a=isSet(arguments[2])?arguments[2]:" ",i=isSet(arguments[3])?arguments[3]:"1";e+="";i+="";switch(i){case"0":e=e.padStart(t,a);break;case"1":e=e.padEnd(t,a);break;case"2":e=e.padStart(Math.floor((t-e.length)/2+e.length),a);e=e.padEnd(t,a);break}return e},strEncode:function(){var e=isSet(arguments[0])?arguments[0]:{},i=[];if(!isAorO(e))return e;$.each(e,function(a,e){e=fxBase["text"]["strEncodeMerge"](e);$.each(e,function(e,t){i.push(a+t)})});i=fxBase["text"]["implode"]("&",i);return i},strEncodeMerge:function(a){var i=[];if(!isAorO(a)){a=encodeURIComponent(a);return["="+a]}$.each(a,function(e,t){t=fxBase["text"]["strEncodeMerge"](t);if(isObject(a)){i.push("["+e+"]"+t)}else{i.push("[]"+t)}});return i},strDecode:function(){var e=isSet(arguments[0])?arguments[0]:null,a={};if(isAorO(e))return e;e=fxBase["text"]["explode"]("&",e);$.each(e,function(e,t){t=fxBase["text"]["explode"]("=",t,2);if(isBlank(t[0])&&!isSet(t[1]))return true;try{t[0]=isSet(t[0])?decodeURIComponent(t[0]):t[0]}catch(e){}try{t[1]=isSet(t[1])?decodeURIComponent(t[1]):t[1]}catch(e){}t[0]=fxBase["text"]["replace"]("^([^[]*)","[$1]",t[0]);t[2]=a;t=fxBase["text"]["strDecodeMerge"](t);a=fxBase["param"]["merge"](a,t[2])});return a},strDecodeMerge:function(e){var a={};a["find"]=new RegExp(/^\[([^\]]*)\]/);a["key"]=e[0].match(a["find"]);e[0]=fxBase["text"]["replace"]("^\\[[^\\]]*\\]","",e[0]);if(isEmpty(a["key"])){return{}}e[2]=isSet(e[2])?e[2]:[];if(a["key"][0]!="[]"&&isArray(e[2])){e[2]=fxBase["param"]["merge"]({},e[2])}if(a["key"][0]=="[]"){a["key"][1]=-1;$.each(e[2],function(e,t){if(!isNumeric(e)||Math.floor(e)!=e)return true;a["key"][1]=a["key"][1]>e?a["key"][1]:e});a["key"][1]++}if(isSet(e[0].match(a["find"]))){e[2][a["key"][1]]=fxBase["text"]["strDecodeMerge"]([e[0],e[1],e[2][a["key"][1]]])[2]}else if(isArray(e[2])){e[2].push(e[1])}else{e[2][a["key"][1]]=e[1]}return e}});var fxApp=new function(){return isObject(fxApp)?fxApp:{}};fxApp["base"]=Object.assign(isObject(fxApp["base"])?fxApp["base"]:{},{});fxApp["data"]=Object.assign(isObject(fxApp["data"])?fxApp["data"]:{},{});fxApp["user"]=Object.assign(isObject(fxApp["user"])?fxApp["user"]:{},{});fxApp["view"]=Object.assign(isObject(fxApp["view"])?fxApp["view"]:{},{});fxApp["rank"]=Object.assign(isObject(fxApp["rank"])?fxApp["rank"]:{},{});fxApp["console"]=Object.assign(isObject(fxApp["console"])?fxApp["console"]:{},{app:function(){var e={env:{title:$("title").html()}};fxApp=fxBase["param"]["merge"](fxApp,e,arguments[0])},env:function(){var e=$(".moire-data").html();e=JSON.parse(isSet(e)?e:"{}");$.each(e,function(e,t){fxApp[e]=fxBase["param"]["merge"](fxApp[e],t)});fxApp["param"]=fxBase["param"]["url"]({type:"2.1"})},copyright:function(){var e={switch:true};e=fxBase["param"]["merge"](e,arguments[0]);if(e["switch"]!==true||self!=top)return;console.log("%c"+fxBase["base"]["lang"](["site console1"])+"\n%c"+fxBase["base"]["lang"](["site console2"]),"color: #9173a9;","color: #a6a7d7;")},clear:function(){var e={switch:true};e=fxBase["param"]["merge"](e,arguments[0]);if(e["switch"]!==true||self!=top)return;clearInterval(fxApp["rank"]["timer.console.clear"]);fxApp["rank"]["timer.console.clear"]=setInterval(function(){console.clear();fxApp["console"]["copyright"](true);console.log(fxBase["text"]["time"]()+"\n"+fxBase["base"]["lang"](["log","auto","clear",",","interval","60","minute"]))},60*60*1e3)}});fxApp["env"]["ie"]=fxBase["client"]["ieVersion"]();fxApp["env"]["sheet"]=document.styleSheets;var fxView=new function(){return isObject(fxView)?fxView:{}};fxView["cache"]=Object.assign(isObject(fxView["cache"])?fxView["cache"]:{},{echo:{},elem:{},plugin:[],view:{}});fxView["custom"]=Object.assign(isObject(fxView["custom"])?fxView["custom"]:{},{});fxView["deploy"]=Object.assign(isObject(fxView["deploy"])?fxView["deploy"]:{},{});fxView["machine"]=Object.assign(isObject(fxView["machine"])?fxView["machine"]:{},{});fxView["material"]=Object.assign(isObject(fxView["material"])?fxView["material"]:{},{});fxView["mould"]=Object.assign(isObject(fxView["mould"])?fxView["mould"]:{},{});fxView["shelf"]=Object.assign(isObject(fxView["shelf"])?fxView["shelf"]:{},{});fxView["store"]=Object.assign(isObject(fxView["store"])?fxView["store"]:{},{});fxView["store"]["deal"]=function(){var t={url:null,type:"post",cache:false,data:{base:{token:fxView["machine"]["caller"](["user","base","token"],null,fxApp),format:"json"},data:{}},success:e,error:a,extend:{elem:null,tips:true}};t=fxBase["param"]["merge"](t,arguments[0]);t["echo"]={};$.ajax(t);function e(e){t["echo"]=e;if(!t["extend"]["tips"])return;if(e["code"]==-1){e["message"]=fxBase["base"]["lang"](["system","abend"])}if(e["code"]==200&&isSet(t["extend"]["elem"])){layui.layer.tips(e["message"],$(t["extend"]["elem"]),{time:800,tips:fxBase["math"]["rand"](1,4),tipsMore:true})}else if(e["code"]==200){layui.layer.msg(e["message"],{time:800})}else{$.toast({text:e["message"],icon:"error",hideAfter:2e3,position:"top-right",stack:3})}}function a(e){$.toast({text:e["responseText"],icon:"error",hideAfter:2e3,position:"top-right",stack:3})}return t["echo"]};fxView["store"]["purchase"]=function(){var n={url:null,type:"get",async:false,data:{base:{page:1,limit:-1}},success:e,error:t,deploy:null,extend:{tips:false,level:1,key:null,keyNexus:"-",value:null,valueNexus:" - "}};n=fxBase["param"]["merge"](n,arguments[0]);if(isBlank(n["extend"]["key"])){n["extend"]["key"]=["id"]}else if(!isAorO(n["extend"]["key"])){n["extend"]["key"]=fxBase["text"]["explode"](",",n["extend"]["key"])}if(isBlank(n["extend"]["value"])){n["extend"]["value"]=["id","name"]}else if(!isAorO(n["extend"]["value"])){n["extend"]["value"]=fxBase["text"]["explode"](",",n["extend"]["value"])}n["echo"]={key:{},value:{}};fxView["store"]["deal"](n);function e(e){if(e["code"]==200){if(n["extend"]["level"]!=2){e["data"]=[e["data"]]}$.each(e["data"],function(i,e){n["echo"]["value"][i]={};$.each(e,function(e,a){n["echo"]["key"]=[];$.each(n["extend"]["key"],function(e,t){n["echo"]["key"].push(!isUndefined(a[t])?a[t]:t)});n["echo"]["key"]=fxBase["text"]["implode"](n["extend"]["keyNexus"],n["echo"]["key"]);n["echo"]["value"][i][n["echo"]["key"]]=[];$.each(n["extend"]["value"],function(e,t){n["echo"]["value"][i][n["echo"]["key"]].push(!isUndefined(a[t])?a[t]:t)});n["echo"]["value"][i][n["echo"]["key"]]=fxBase["text"]["implode"](n["extend"]["valueNexus"],n["echo"]["value"][i][n["echo"]["key"]])})});if(isFunction(n["deploy"])){n["deploy"](n)}}}function t(e){}};fxView["store"]["supply"]=function(){fxView["shelf"]={attr:{},base:{},data:fxView["machine"]["caller"](["view","enum"],null,fxApp),view:{elem:null,model:{key:"id"},api:{},data:{key:function(e){var t={};if(!isBlank(e[fxView["shelf"]["view"]["model"]["key"]])){t["data"]={};t["data"][fxView["shelf"]["view"]["model"]["key"]]=e[fxView["shelf"]["view"]["model"]["key"]]}return t}},page:{},param:null}};fxView["shelf"]=fxBase["param"]["merge"](fxView["shelf"],arguments[0]);$.each(fxView["shelf"]["base"],function(e,t){if(!isBlank(t["url"])){t=fxBase["param"]["merge"]({deploy:function(a){$.each(a["echo"]["value"],function(e,t){a["extend"]["index"][e]=!isBlank(a["extend"]["index"][e])?a["extend"]["index"][e]:e;fxView["shelf"]["data"][a["extend"]["index"][e]]=t})},extend:{index:{}}},t);if(isEmpty(t["extend"]["index"])){t["extend"]["index"]={0:e}}fxView["store"]["purchase"](t)}else{fxView["shelf"]["data"][e]=t}})};fxView["store"]["facade"]=function(){var e={elem:null};e=fxBase["param"]["merge"](e,arguments[0]);if(isObject(fxView["machine"]["caller"](["deploy","view",e["elem"]]))){e["data"]=fxBase["param"]["merge"]({base:{elem:null}},fxView["machine"]["caller"](["deploy","view",e["elem"]]))}else{e["data"]={base:fxBase["param"]["merge"]({elem:null},e)}}if(isBlank(fxView["machine"]["caller"](["view","elems",e["elem"]],null,fxApp))){fxApp["view"]["subtitle"]=fxBase["base"]["lang"]([e["elem"]]);fxApp["view"]["title"]=fxBase["base"]["lang"]([fxApp["view"]["name"],e["elem"]]);$("title").html(fxBase["base"]["lang"]([fxApp["view"]["title"]," - ","site title"]));fxApp["env"]["title"]=$("title").html()}if(isFunction(fxView["machine"]["caller"](["custom",e["data"]["base"]["elem"]]))){fxView["machine"]["caller"](["custom",e["data"]["base"]["elem"]],[e["data"]])}else if(isFunction(fxView["machine"]["caller"](["mould","view",e["data"]["base"]["elem"],"main"]))){fxView["machine"]["caller"](["mould","view",e["data"]["base"]["elem"],"main"],[e["data"]])}else{fxView["machine"]["caller"](["mould","tool","message","main"],[{text:[e["data"]["base"]["elem"],"plugin","not loaded"]}]);if(top.fxApp["rank"]["self.layer.index.list"].length>0){fxApp["rank"]["self.layer.close"](top.fxApp["rank"]["self.layer.index.list"][0])}}};fxApp["env"]["factory"]=fxApp["env"]["script"]+"/view/";fxView["machine"]["loader"]=function(){var i={0:[],1:{name:[],path:null,web:fxApp["env"]["factory"],version:fxApp["env"]["version"]},2:null};i=fxBase["param"]["merge"](i,arguments);i["plugin"]=i[0];i["config"]=i[1];i["callback"]=i[2];if(isBlank(i["plugin"])){i["plugin"]=[]}else if(!isAorO(i["plugin"])){i["plugin"]=fxBase["text"]["explode"](",",i["plugin"])}if(isBlank(i["config"]["name"])){i["config"]["name"]=[]}else if(!isAorO(i["config"]["name"])){i["config"]["name"]=fxBase["text"]["explode"](",",i["config"]["name"])}$.each(i["plugin"],function(e,a){$.each(i["config"]["name"],function(e,t){if(!isSet(i["config"]["path"])||!isSet(t))return true;i["model"]=[i["config"]["web"],i["config"]["path"],"/",a,"/",t];i["model"]=fxBase["text"]["implode"]("",i["model"]);if(!isBlank(i["config"]["version"])){i["model"]=fxBase["text"]["implode"]("",[i["model"],"?version=",i["config"]["version"]])}if(fxBase["param"]["inArray"](i["model"],fxView["cache"]["plugin"]))return true;fxView["cache"]["plugin"].push(i["model"]);document.write('<script type="text/javascript" src="'+i["model"]+'"><\/script>')})});if(isFunction(i["callback"])){$(document).ready(function(){i["callback"]()})}};fxView["machine"]["deployer"]=function(){var i={0:[],1:null,2:null};i=fxBase["param"]["merge"](i,arguments);i["chain"]=i[0];i["data"]=i[1];i["base"]=isSet(i[2])?i[2]:fxView;if(!isArray(i["chain"]))return false;if(isObject(i["data"])){i["echo"]={};$.each(i["data"],function(e,a){e=fxBase["text"]["explode"](",",e);$.each(e,function(e,t){i["echo"][t]=a})});i["data"]=i["echo"]}$.each(i["chain"].reverse(),function(e,t){t=fxBase["text"]["explode"](",",t);i["echo"]={};$.each(t,function(e,t){i["echo"][t]=i["data"]});i["data"]=i["echo"]});i["base"]=fxBase["param"]["merge"](i["base"],i["data"])};fxView["machine"]["caller"]=function(){var a={0:[],1:null,2:null};a=fxBase["param"]["merge"](a,arguments);a["chain"]=a[0];a["data"]=a[1];a["base"]=isSet(a[2])?a[2]:fxView;if(!isArray(a["chain"]))return false;a["exit"]=true;a["name"]="";$.each(a["chain"],function(e,t){a["name"]=t;if(isUndefined(a["base"][a["name"]]))return a["exit"]=false;a["base"]=a["base"][a["name"]]});if(!a["exit"]){a["echo"]=undefined}else if(isFunction(a["base"])&&isArray(a["data"])){a["echo"]=a["base"].apply(null,a["data"])}else{a["echo"]=a["base"]}return a["echo"]};fxView["machine"]["darker"]=function(){var e=fxBase["param"]["merge"](arguments[0],{id:"",field:"",data:null,dataRaw:null,dataPrefix:"",dataSuffix:"",dataEcho:null,echo:null,list:[],run:{init:0,data:0,deploy:0,done:0,echo:0,reset:0,clean:0},event:{},title:"",define:0,require:0,option:{},shelf:{}},isObject(arguments[1])?arguments[1]:{});e=fxBase["param"]["merge"](e,{label:[e["title"]]},e);e["label"]=fxBase["base"]["lang"](e["label"]);e["requireMark"]=e["require"]==1?"<span>*</span>":"";if(e["define"]==1&&!isSet(e["data"])){e["requireMark"]+=fxBase["base"]["lang"](["<span>","(","field","[",fxApp["view"]["langc"]["prefix"]+e["field"],"]","undefined",")","</span>"])}e["skins"]=fxView["machine"]["caller"](["material","elem",e["type"],"skin"]);return e};fxView["layui"]=Object.assign(isObject(fxView["layui"])?fxView["layui"]:{},{init:function(){var e={type:null,id:null,plugin:{radio:false}};var t={};e=fxBase["param"]["merge"](e,arguments[0]);switch(e["type"]){case"table":var a=$(".layui-table-view .layui-table td[data-edit=text]");a.off("click");a.on("click",function(){if(!isSet($(this).attr("fxy-edit")))return false;$(this).removeAttr("fxy-edit")});a.off("dblclick");a.on("dblclick",function(){$(this).attr("fxy-edit",1);$(this).trigger("click")});break;case"select":if(!e["plugin"]["radio"]){t["btns"]=["select","remove","reverse"]}else{t["btns"]=["remove"]}layui.formSelects.btns(e["id"],t["btns"],{show:"name",space:"6px"});$(".xm-select-parent .xm-form-select dl dt").each(function(){if($(this).text()!=""){$(this).html($(this).html()+'<span class="xm-select-tips-sm">'+'<a fxy-type="1">'+fxBase["base"]["lang"](["lay 全选"])+"</a>"+'<a fxy-type="2">'+fxBase["base"]["lang"](["lay 清空"])+"</a>"+'<a fxy-type="3">'+fxBase["base"]["lang"](["lay 反选"])+"</a>"+"</span>")}});$(".xm-select-parent .xm-select").height("");$(".xm-select-tips-sm").off("click");$(".xm-select-tips-sm").on("click",function(e){var a=$(e.target);if(!a.is("a"))return false;a.parents("dt").nextUntil("dt").each(function(e,t){t=$(t);if(t.hasClass("xm-dis-disabled"))return true;switch(a.attr("fxy-type")){default:return true;case"1":if(t.hasClass("xm-select-this"))return true;break;case"2":if(!t.hasClass("xm-select-this"))return true;break;case"3":break}t.find("i:not(.icon-expand)").trigger("click")});return false});fxView["layui"]["select"]({elem:$(".xm-select-label")});break}},select:function(){var n={elem:null,switch:true};var s={};n=fxBase["param"]["merge"](n,arguments[0]);if(!isSet(n["elem"])){console.log(fxBase["base"]["lang"](["please","choice","valid","HTML","label"]));return}$(n["elem"]).off("mousedown",e);$(n["elem"]).off("touchstart",e);if(!n["switch"])return;$(n["elem"]).on("mousedown",e);$(n["elem"]).on("touchstart",e);function e(e){var t;if(e.originalEvent.targetTouches){t=e.originalEvent.targetTouches[0]}else{t=e;if(e.button!=0)return}s["elem"]=$(this);if(s["elem"].children("span").length==0)return;s["parent"]=s["elem"].parent();s["elemW"]=s["elem"].find("span:last").offset().left+s["elem"].find("span:last").outerWidth(true)+parseInt(s["elem"].css("padding-left"))-s["elem"].find("span:first").offset().left;if(s["elemW"]<=s["parent"].width())return;var a=s["elem"].offset().left,i=parseFloat(s["elem"].css("left"));n["getX"]=t.pageX-(a+(i-a));$(document).on("mousemove",r);$(this).on("touchmove",r);$(document).on("mouseup",l);$(this).on("touchend",l)}function r(e){var t;if(e.originalEvent.targetTouches){t=e.originalEvent.targetTouches[0]}else{t=e}var a=t.pageX-n["getX"],i=s["parent"].width()-s["elemW"]-34;if(a>0){a=0}else if(a<i){a=i}s["elem"].css({left:a})}function l(){$(document).off("mousemove",r);$(document).off("mouseup",l);$(this).off("touchmove",r);$(this).off("touchend",l)}}});